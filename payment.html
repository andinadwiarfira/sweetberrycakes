<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Pembayaran SweetBerry</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    body{
      font-family:"Poppins",system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
      background:linear-gradient(135deg,#ffe6f3 0%,#ffeef7 60%);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:1.5rem .75rem;
    }
    .pay-card{
      background:#fff;
      border-radius:20px;
      padding:1.8rem 1.6rem;
      box-shadow:0 18px 40px rgba(224,59,130,.35);
      max-width:460px;
      width:100%;
    }
    .badge-soft{
      background:#ffebf5;
      color:#e03b82;
      border-radius:999px;
      font-size:.75rem;
      padding:.2rem .7rem;
    }
    .total-text{
      font-size:1.1rem;
      font-weight:600;
      color:#e03b82;
    }
    .method-pill{
      border-radius:14px;
      border:1px solid #ffd0e0;
      padding:.45rem .7rem;
      font-size:.8rem;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:.45rem;
      margin-bottom:.4rem;
      transition:all .18s ease;
    }
    .method-pill i{
      font-size:1rem;
    }
    .method-pill.active{
      background:#ffe6f3;
      border-color:#ff5f9a;
      box-shadow:0 8px 20px rgba(224,59,130,.25);
      color:#e03b82;
    }
    .btn-pay{
      border-radius:999px;
      width:100%;
      padding:.6rem 1rem;
      border:none;
      background:linear-gradient(135deg,#ff5f9a,#e03b82);
      color:#fff;
      text-transform:uppercase;
      letter-spacing:.12em;
      font-size:.8rem;
      box-shadow:0 14px 32px rgba(224,59,130,.55);
    }
    .btn-pay:disabled{
      opacity:.7;
      cursor:not-allowed;
      box-shadow:none;
    }
    .icon-circle{
      width:70px;
      height:70px;
      border-radius:50%;
      background:linear-gradient(135deg,#ffb7d7,#ff5f9a);
      display:flex;
      align-items:center;
      justify-content:center;
      color:#fff;
      font-size:2rem;
      margin:0 auto 1rem auto;
    }
    .bank-info{
      background:#fff7fb;
      border-radius:14px;
      padding:.6rem .75rem;
      border:1px dashed #ff9cc7;
      font-size:.8rem;
    }
    .bank-info code{
      font-size:.85rem;
      background:transparent;
      padding:0;
      color:#e03b82;
      font-weight:600;
    }
    @media (max-width:575.98px){
      .pay-card{
        padding:1.4rem 1.2rem;
      }
    }
        .btn-back{
      border:none;
      background:transparent;
      color:#e03b82;
      font-size:.8rem;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width:100%;
      text-decoration:none;
      padding-top:.3rem;
      padding-bottom:.1rem;
      font-weight:500;
    }
    .btn-back i{
      font-size:1rem;
    }
    .btn-back:hover{
      color:#c52b6c;
    }

  </style>
</head>
<body>

<div class="pay-card">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <div>
      <h5 class="mb-0">Pembayaran</h5>
      <small class="text-muted" id="order-code-text">Kode pesanan: -</small>
    </div>
    <span class="badge-soft">SweetBerry Cakes</span>
  </div>

  <p class="text-muted mb-3 small">
    Cek kembali total pembayaran dan pilih metode yang kamu inginkan, lalu tekan tombol bayar.
  </p>

  <div class="d-flex justify-content-between align-items-center mb-1">
    <span class="small text-muted">Total yang harus dibayar</span>
    <span class="total-text" id="pay-total">Rp0</span>
  </div>
  <p class="small text-muted mb-3">
    Harga sudah termasuk pajak dan biaya layanan dasar.
  </p>

  <!-- Metode pembayaran (UI saja) -->
  <p class="small fw-semibold mb-1">Pilih metode pembayaran</p>
  <div class="mb-2">
    <div class="method-pill active" data-method="bank">
      <i class="bi bi-bank"></i>
      <span>Transfer Bank / Virtual Account</span>
    </div>
    <div class="method-pill" data-method="ewallet">
      <i class="bi bi-phone"></i>
      <span>E‑Wallet (OVO, Dana, GoPay)</span>
    </div>
  </div>

  <div class="bank-info mb-3" id="bank-info">
    <div class="d-flex justify-content-between">
      <span>Bank BCA a.n. SweetBerry</span>
      <span class="badge-soft">VA simulasi</span>
    </div>
    <div class="mt-1">
      No. Rek / VA: <code>1234 567 890</code><br>
      Berita transfer: <code id="ref-short">SWEETBERRY</code>
    </div>
  </div>

  <button class="btn-pay" id="btn-pay">
    Bayar sekarang
  </button>

  <button class="btn-back mt-2" onclick="window.location.href='order.html'">
  <i class="bi bi-arrow-left-circle me-1"></i>
  Kembali ke menu
</button>

</div>

<script>
  function formatRupiah(num){
    return 'Rp' + num.toLocaleString('id-ID');
  }

  // ambil total & optional orderCode dari query string ?total=...&code=...
  const params = new URLSearchParams(window.location.search);
  const total = parseInt(params.get('total') || '0',10);
  const orderCode = params.get('code') || ('SB-' + Date.now().toString().slice(-6));

  document.getElementById('pay-total').textContent = formatRupiah(total);
  document.getElementById('order-code-text').textContent = 'Kode pesanan: ' + orderCode;
  document.getElementById('ref-short').textContent = orderCode;

  // pilih metode
  let currentMethod = 'bank';
  document.querySelectorAll('.method-pill').forEach(pill=>{
    pill.addEventListener('click',()=>{
      document.querySelectorAll('.method-pill').forEach(p=>p.classList.remove('active'));
      pill.classList.add('active');
      currentMethod = pill.getAttribute('data-method');
      document.getElementById('bank-info').style.display =
        currentMethod === 'bank' ? 'block' : 'none';
    });
  });

  const payBtn = document.getElementById('btn-pay');

  payBtn.addEventListener('click',()=>{
    if(total <= 0){
      Swal.fire({
        icon:'warning',
        title:'Tidak ada total pembayaran',
        text:'Silakan kembali ke halaman Order dan pilih menu terlebih dahulu.',
        confirmButtonColor:'#e03b82'
      });
      return;
    }

    // simulasi proses pembayaran: tampilkan loading dulu
    Swal.fire({
      title: 'Memproses pembayaran...',
      text: 'Mohon tunggu beberapa detik.',
      allowOutsideClick:false,
      allowEscapeKey:false,
      didOpen: () => {
        Swal.showLoading();
      }
    });

    payBtn.disabled = true;

    setTimeout(()=>{
      Swal.close();

      const ref = 'PAY-' + Math.floor(100000 + Math.random()*900000);
      const methodText = currentMethod === 'bank'
        ? 'Transfer Bank / Virtual Account'
        : 'E‑Wallet';

      Swal.fire({
        html: `
          <div class="icon-circle">
            <i class="bi bi-check-circle-fill"></i>
          </div>
          <h3 class="mb-1">Pembayaran Berhasil</h3>
          <p class="mb-1" style="font-size:0.9rem;">Terima kasih, pesananmu sudah tercatat.</p>
          <p class="mb-1" style="font-size:0.85rem;">
            Total dibayar: <strong>${formatRupiah(total)}</strong>
          </p>
          <p class="mb-1" style="font-size:0.85rem;">
            Metode: <strong>${methodText}</strong>
          </p>
          <p class="mb-1" style="font-size:0.8rem;color:#8f7b80;">
            Kode pesanan: <strong>${orderCode}</strong><br>
            Ref. pembayaran: <strong>${ref}</strong>
          </p>
          <p class="mb-2 mt-2" style="font-size:0.8rem;color:#8f7b80;">
            Simpan layar ini sebagai bukti pembayaran atau screenshot untuk dikirim ke admin.
          </p>
          <button id="btn-go-home"
                  style="
                    margin-top:4px;
                    border:none;
                    border-radius:999px;
                    padding:.55rem 1.4rem;
                    background:linear-gradient(135deg,#ff5f9a,#e03b82);
                    color:#fff;
                    font-size:.8rem;
                    text-transform:uppercase;
                    letter-spacing:.12em;
                    display:inline-flex;
                    align-items:center;
                    gap:.4rem;
                    cursor:pointer;
                  ">
            <i class="bi bi-house-door-fill"></i>
            <span>kembali ke beranda</span>
          </button>
        `,
        showConfirmButton:false,
        allowOutsideClick:false,
        allowEscapeKey:false,
        didOpen: () => {
          const btn = document.getElementById('btn-go-home');
          btn.addEventListener('click', () => {
            window.location.href = 'index.html';
          });
        }
      });

      payBtn.disabled = false;
    }, 1500); // 1.5 detik simulasi proses
  });
</script>

</body>
</html>
